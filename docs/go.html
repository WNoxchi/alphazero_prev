---

title: State Engine: Go


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/go.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/go.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>AlphaZero queries the state engine to get new simulation states. The engine takes a state and action, and returns a new state and an array of valid actions.</p>
<p>This code is adapted from <a href="https://github.com/tensorflow/minigo/blob/master/go.py">https://github.com/tensorflow/minigo/blob/master/go.py</a>, commit <a href="https://github.com/tensorflow/minigo/commit/7b44376c4266ed41ba397dfe79ba87f040c0e35f">7b44376</a>, under the Apache 2.0 license.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Go-Engine">Go Engine<a class="anchor-link" href="#Go-Engine"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <code>board</code> is an NxN numpy array.</p>
<p>A <code>Coordinate</code> is a tuple index into the board.</p>
<p>A <code>Move</code> is a <code>(Coordinate c | None)</code>. (coordinate or null)</p>
<p>A <a href="/alphazero/go.html#PlayerMove"><code>PlayerMove</code></a> is a <code>(Color, Move)</code> tuple.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Represent a baord as a numpy array. <code>0</code>: empty, <code>1</code>: black, <code>-1</code>: white. Swapping colors is as simple as multiplying an array by -1.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/alphazero/go.html#MISSING_GROUP_ID"><code>MISSING_GROUP_ID</code></a> represents "group not found" in the <a href="/alphazero/go.html#LibertyTracker"><code>LibertyTracker</code></a> object.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IllegalMove" class="doc_header"><code>class</code> <code>IllegalMove</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L36" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IllegalMove</code>() :: <code>Exception</code></p>
</blockquote>
<p>Common base class for all non-exit exceptions.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PlayerMove" class="doc_header"><code>class</code> <code>PlayerMove</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L37" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PlayerMove</code>(<strong><code>color</code></strong>, <strong><code>move</code></strong>) :: <a href="/alphazero/go.html#PlayerMove"><code>PlayerMove</code></a></p>
</blockquote>
<p>PlayerMove(color, move)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PositionWithContext" class="doc_header"><code>class</code> <code>PositionWithContext</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L38" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PositionWithContext</code>(<strong><code>position</code></strong>, <strong><code>next_move</code></strong>, <strong><code>result</code></strong>) :: <code>SgfPosition</code></p>
</blockquote>
<p>SgfPosition(position, next_move, result)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="place_stones" class="doc_header"><code>place_stones</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>place_stones</code>(<strong><code>board</code></strong>, <strong><code>color</code></strong>, <strong><code>stones</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="replace_position" class="doc_header"><code>replace_position</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>replace_position</code>(<strong><code>position</code></strong>, <strong><code>result</code></strong>)</p>
</blockquote>
<p>Wrapper for a go.Position which replays its history.
Assumes an empty start position (ie. no handicap and history must be exhaustive).</p>
<p>Result must be passed in, since a resign can't be inferred from position history alone.</p>

<pre><code>for position_w_context in replace_position(position):
    print(position_w_context.position)</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_reached" class="doc_header"><code>find_reached</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L63" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_reached</code>(<strong><code>board</code></strong>, <strong><code>c</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_koish" class="doc_header"><code>is_koish</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_koish</code>(<strong><code>board</code></strong>, <strong><code>c</code></strong>)</p>
</blockquote>
<p>Checks if <code>c</code> is surrounded on all sides by 1 color, and returns that color.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_eyeish" class="doc_header"><code>is_eyeish</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_eyeish</code>(<strong><code>board</code></strong>, <strong><code>c</code></strong>)</p>
</blockquote>
<p>Checks if <code>c</code> is an eye, for the purpose of restricting MC rollouts.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Group" class="doc_header"><code>class</code> <code>Group</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L113" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Group</code>(<strong><code>id</code></strong>, <strong><code>stones</code></strong>, <strong><code>liberties</code></strong>, <strong><code>color</code></strong>) :: <a href="/alphazero/go.html#Group"><code>Group</code></a></p>
</blockquote>
<p>stones: a frozenset of Coordinates belonging to this group.
liberties: a frozenset of Coordinates that are empty and adjacent to this group.
color: color of this group.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LibertyTracker" class="doc_header"><code>class</code> <code>LibertyTracker</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L124" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LibertyTracker</code>(<strong><code>group_index</code></strong>=<em><code>None</code></em>, <strong><code>groups</code></strong>=<em><code>None</code></em>, <strong><code>liberty_cache</code></strong>=<em><code>None</code></em>, <strong><code>max_group_id</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Position" class="doc_header"><code>class</code> <code>Position</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L260" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Position</code>(<strong><code>board</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>0</code></em>, <strong><code>komi</code></strong>=<em><code>7.5</code></em>, <strong><code>caps</code></strong>=<em><code>(0, 0)</code></em>, <strong><code>lib_tracker</code></strong>=<em><code>None</code></em>, <strong><code>ko</code></strong>=<em><code>None</code></em>, <strong><code>recent</code></strong>=<em><code>()</code></em>, <strong><code>board_deltas</code></strong>=<em><code>None</code></em>, <strong><code>to_play</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Go-Coordinate-Helpers">Go Coordinate Helpers<a class="anchor-link" href="#Go-Coordinate-Helpers"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This code is adapted from <a href="https://github.com/tensorflow/minigo/blob/master/coords.py">https://github.com/tensorflow/minigo/blob/master/coords.py</a>, commit <a href="https://github.com/tensorflow/minigo/commit/ac169db7e002c152489615dd45f06c5ba7ee77fc">ac169db</a>, under the Apache 2.0 license.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>More than 19 entries are provided, for boards larger than 19x19.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="from_flat" class="doc_header"><code>from_flat</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L516" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>from_flat</code>(<strong><code>flat</code></strong>)</p>
</blockquote>
<p>Converts from a flattened coordinate to a Go coordinate</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_flat" class="doc_header"><code>to_flat</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L522" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_flat</code>(<strong><code>coord</code></strong>)</p>
</blockquote>
<p>Converts from a Go coordinate to a flattened coordinate.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="from_sgf" class="doc_header"><code>from_sgf</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L528" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>from_sgf</code>(<strong><code>sgfc</code></strong>)</p>
</blockquote>
<p>Converts from an SGF coordinate to a Go coordinate.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_sgf" class="doc_header"><code>to_sgf</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L534" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_sgf</code>(<strong><code>coord</code></strong>)</p>
</blockquote>
<p>Converts from a Go coordinate to an SGF coordinate.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="from_gtp" class="doc_header"><code>from_gtp</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L540" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>from_gtp</code>(<strong><code>gtpc</code></strong>)</p>
</blockquote>
<p>Converts from a GTP coordinate to a Go coordinate.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="to_gtp" class="doc_header"><code>to_gtp</code><a href="https://github.com/WNoxchi/alphazero/tree/master/alphazero/go.py#L549" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>to_gtp</code>(<strong><code>coord</code></strong>)</p>
</blockquote>
<p>Converts from a Go coordinate to a GTP coordinate.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

